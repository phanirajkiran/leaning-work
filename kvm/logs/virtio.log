********************************************************************
Firstly,create the publickey for passwordless login and other env

********************************************************************
Load the kvm modules 

kvm                   403168  1 kvm_intel
kvm_intel             128807  0 
kvm has been loaded
load kvm-intel module successfully
********************************************************************
Destroy the exsiting vm 

********************************************************************
Start boot the Guest,The Qemu command is :

/usr/bin/qemu-system-x86_64 -smp 2 -m 512 -net nic,macaddr=de:ef:be:47:25:14,model=virtio -net tap,script=/etc/qemu-ifup -hda /boot/guest_img.raw  -kernel /boot/bzImage -append "root=/dev/hda rw console=ttyS0,115200 ip=dhcp"  -nographic &
********************************************************************
Guest is booting ...

This script will establish a bridge, which
including a tap0 and eth0. Please be sure
that brctl, ifconfig and route can be here
QEMU 1.1.0 monitor - type 'help' for more information
(qemu) QEMU 1.1.0 monitor - type 'help' for more information
(qemu) 
Initializing cgroup subsys cpuset
Initializing cgroup subsys cpu
Linux version 3.4.20-WR5.0.1.0_standard (lyang0@pek-lpgtest4) (gcc version 4.6.4 20120303 (prerelease) (GCC) ) #2 SMP PREEMPT Sun Dec 23 01:28:36 CST 2012
Command line: root=/dev/hda rw console=ttyS0,115200 ip=dhcp
BIOS-provided physical RAM map:
 BIOS-e820: 0000000000000000 - 000000000009fc00 (usable)
 BIOS-e820: 000000000009fc00 - 00000000000a0000 (reserved)
 BIOS-e820: 00000000000f0000 - 0000000000100000 (reserved)
 BIOS-e820: 0000000000100000 - 000000001fffe000 (usable)
 BIOS-e820: 000000001fffe000 - 0000000020000000 (reserved)
 BIOS-e820: 00000000fffc0000 - 0000000100000000 (reserved)
NX (Execute Disable) protection: active
DMI 2.4 present.
No AGP bridge found
last_pfn = 0x1fffe max_arch_pfn = 0x400000000
x86 PAT enabled: cpu 0, old 0x7040600070406, new 0x7010600070106
found SMP MP-table at [ffff8800000fda20] fda20
init_memory_mapping: 0000000000000000-000000001fffe000
ACPI: RSDP 00000000000fd890 00014 (v00 BOCHS )
ACPI: RSDT 000000001fffe440 00034 (v01 BOCHS  BXPCRSDT 00000001 BXPC 00000001)
ACPI: FACP 000000001fffff80 00074 (v01 BOCHS  BXPCFACP 00000001 BXPC 00000001)
ACPI: DSDT 000000001fffe480 011BC (v01   BXPC   BXDSDT 00000001 INTL 20120913)
ACPI: FACS 000000001fffff40 00040
ACPI: SSDT 000000001ffff7a0 00796 (v01 BOCHS  BXPCSSDT 00000001 BXPC 00000001)
ACPI: APIC 000000001ffff680 00080 (v01 BOCHS  BXPCAPIC 00000001 BXPC 00000001)
ACPI: HPET 000000001ffff640 00038 (v01 BOCHS  BXPCHPET 00000001 BXPC 00000001)
No NUMA configuration found
Faking a node at 0000000000000000-000000001fffe000
Initmem setup node 0 0000000000000000-000000001fffe000
  NODE_DATA [000000001fff7000 - 000000001fffafff]
Zone PFN ranges:
  DMA      0x00000010 -> 0x00001000
  DMA32    0x00001000 -> 0x00100000
  Normal   empty
Movable zone start PFN for each node
Early memory PFN ranges
    0: 0x00000010 -> 0x0000009f
    0: 0x00000100 -> 0x0001fffe
ACPI: PM-Timer IO Port: 0xb008
ACPI: LAPIC (acpi_id[0x00] lapic_id[0x00] enabled)
ACPI: LAPIC (acpi_id[0x01] lapic_id[0x01] enabled)
ACPI: LAPIC_NMI (acpi_id[0xff] dfl dfl lint[0x1])
ACPI: IOAPIC (id[0x00] address[0xfec00000] gsi_base[0])
IOAPIC[0]: apic_id 0, version 17, address 0xfec00000, GSI 0-23
ACPI: INT_SRC_OVR (bus 0 bus_irq 0 global_irq 2 dfl dfl)
ACPI: INT_SRC_OVR (bus 0 bus_irq 5 global_irq 5 high level)
ACPI: INT_SRC_OVR (bus 0 bus_irq 9 global_irq 9 high level)
ACPI: INT_SRC_OVR (bus 0 bus_irq 10 global_irq 10 high level)
ACPI: INT_SRC_OVR (bus 0 bus_irq 11 global_irq 11 high level)
Using ACPI (MADT) for SMP configuration information
ACPI: HPET id: 0x8086a201 base: 0xfed00000
SMP: Allowing 2 CPUs, 0 hotplug CPUs
PM: Registered nosave memory: 000000000009f000 - 00000000000a0000
PM: Registered nosave memory: 00000000000a0000 - 00000000000f0000
PM: Registered nosave memory: 00000000000f0000 - 0000000000100000
Allocating PCI resources starting at 20000000 (gap: 20000000:dffc0000)
setup_percpu: NR_CPUS:24 nr_cpumask_bits:24 nr_cpu_ids:2 nr_node_ids:1
PERCPU: Embedded 27 pages/cpu @ffff88001fc00000 s80576 r8192 d21824 u1048576
Built 1 zonelists in Node order, mobility grouping on.  Total pages: 128904
Policy zone: DMA32
Kernel command line: root=/dev/hda rw console=ttyS0,115200 ip=dhcp
PID hash table entries: 2048 (order: 2, 16384 bytes)
Checking aperture...
No AGP bridge found
Memory: 500400k/524280k available (6713k kernel code, 452k absent, 23428k reserved, 6331k data, 728k init)
SLUB: Genslabs=15, HWalign=64, Order=0-3, MinObjects=0, CPUs=2, Nodes=1
Preemptible hierarchical RCU implementation.
NR_IRQS:4352 nr_irqs:512 16
Console: colour VGA+ 80x25
console [ttyS0] enabled
allocated 2097152 bytes of page_cgroup
please try 'cgroup_disable=memory' option if you don't want memory cgroups
Fast TSC calibration using PIT
Detected 2533.313 MHz processor.
Marking TSC unstable due to TSCs unsynchronized
Calibrating delay loop (skipped), value calculated using timer frequency.. 5066.62 BogoMIPS (lpj=2533313)
pid_max: default: 32768 minimum: 301
Security Framework initialized
Dentry cache hash table entries: 65536 (order: 7, 524288 bytes)
Inode-cache hash table entries: 32768 (order: 6, 262144 bytes)
Mount-cache hash table entries: 256
Initializing cgroup subsys debug
Initializing cgroup subsys cpuacct
Initializing cgroup subsys memory
Initializing cgroup subsys devices
Initializing cgroup subsys freezer
Initializing cgroup subsys net_cls
Initializing cgroup subsys blkio
Initializing cgroup subsys net_prio
Initializing cgroup subsys tasks
ACPI: Core revision 20120320
ftrace: allocating 24245 entries in 95 pages
..TIMER: vector=0x30 apic1=0 pin1=2 apic2=-1 pin2=-1
CPU0: AMD QEMU Virtual CPU version 1.1.0 stepping 03
Performance Events: Broken PMU hardware detected, using software events only.
Booting Node   0, Processors  #1 Ok.
Brought up 2 CPUs
Total of 2 processors activated (15727.30 BogoMIPS).
devtmpfs: initialized
NET: Registered protocol family 16
ACPI: bus type pci registered
PCI: Using configuration type 1 for base access
bio: create slab <bio-0> at 0
ACPI: Added _OSI(Module Device)
ACPI: Added _OSI(Processor Device)
ACPI: Added _OSI(3.0 _SCP Extensions)
ACPI: Added _OSI(Processor Aggregator Device)
ACPI: Interpreter enabled
ACPI: (supports S0 S3 S4 S5)
ACPI: Using IOAPIC for interrupt routing
PCI: Using host bridge windows from ACPI; if necessary, use "pci=nocrs" and report a bug
ACPI: PCI Root Bridge [PCI0] (domain 0000 [bus 00-ff])
pci_root PNP0A03:00: host bridge window [io  0x0000-0x0cf7]
pci_root PNP0A03:00: host bridge window [io  0x0d00-0xffff]
pci_root PNP0A03:00: host bridge window [mem 0x000a0000-0x000bffff]
pci_root PNP0A03:00: host bridge window [mem 0x80000000-0xfebfffff]
PCI host bridge to bus 0000:00
pci_bus 0000:00: root bus resource [io  0x0000-0x0cf7]
pci_bus 0000:00: root bus resource [io  0x0d00-0xffff]
pci_bus 0000:00: root bus resource [mem 0x000a0000-0x000bffff]
pci_bus 0000:00: root bus resource [mem 0x80000000-0xfebfffff]
pci 0000:00:01.3: quirk: [io  0xb000-0xb03f] claimed by PIIX4 ACPI
pci 0000:00:01.3: quirk: [io  0xb100-0xb10f] claimed by PIIX4 SMB
 pci0000:00: Unable to request _OSC control (_OSC support mask: 0x1e)
ACPI: PCI Interrupt Link [LNKA] (IRQs 5 *10 11)
ACPI: PCI Interrupt Link [LNKB] (IRQs 5 *10 11)
ACPI: PCI Interrupt Link [LNKC] (IRQs 5 10 *11)
ACPI: PCI Interrupt Link [LNKD] (IRQs 5 10 *11)
vgaarb: device added: PCI:0000:00:02.0,decodes=io+mem,owns=io+mem,locks=none
vgaarb: loaded
vgaarb: bridge control possible 0000:00:02.0
SCSI subsystem initialized
usbcore: registered new interface driver usbfs
usbcore: registered new interface driver hub
usbcore: registered new device driver usb
PCI: Using ACPI for IRQ routing
HPET: 3 timers in total, 0 timers will be used for per-cpu timer
hpet0: at MMIO 0xfed00000, IRQs 2, 8, 0
hpet0: 3 comparators, 64-bit 100.000000 MHz counter
Switching to clocksource hpet
pnp: PnP ACPI init
ACPI: bus type pnp registered
pnp: PnP ACPI: found 8 devices
ACPI: ACPI bus type pnp unregistered
NET: Registered protocol family 2
IP route cache hash table entries: 4096 (order: 3, 32768 bytes)
TCP established hash table entries: 16384 (order: 6, 262144 bytes)
TCP bind hash table entries: 16384 (order: 6, 262144 bytes)
TCP: Hash tables configured (established 16384 bind 16384)
TCP: reno registered
UDP hash table entries: 256 (order: 1, 8192 bytes)
UDP-Lite hash table entries: 256 (order: 1, 8192 bytes)
NET: Registered protocol family 1
RPC: Registered named UNIX socket transport module.
RPC: Registered udp transport module.
RPC: Registered tcp transport module.
RPC: Registered tcp NFSv4.1 backchannel transport module.
pci 0000:00:00.0: Limiting direct PCI/PCI transfers
pci 0000:00:01.0: PIIX3: Enabling Passive Release
pci 0000:00:01.0: Activating ISA DMA hang workarounds
Registering unionfs 2.5.11 (for 3.3.0-rc3)
NFS: Registering the id_resolver key type
Btrfs loaded
msgmni has been set to 977
Block layer SCSI generic (bsg) driver version 0.4 loaded (major 253)
io scheduler noop registered
io scheduler deadline registered
io scheduler cfq registered (default)
LTT : ltt-relay init
pci_hotplug: PCI Hot Plug PCI Core version: 0.5
input: Power Button as /devices/LNXSYSTM:00/LNXPWRBN:00/input/input0
ACPI: Power Button [PWRF]
ACPI: PCI Interrupt Link [LNKC] enabled at IRQ 11
Serial: 8250/16550 driver, 4 ports, IRQ sharing disabled
serial8250: ttyS0 at I/O 0x3f8 (irq = 4) is a 16550A
00:06: ttyS0 at I/O 0x3f8 (irq = 4) is a 16550A
brd: module loaded
loop: module loaded
Uniform Multi-Platform E-IDE driver
piix 0000:00:01.1: IDE controller (0x8086:0x7010 rev 0x00)
piix 0000:00:01.1: not 100% native mode: will probe irqs later
    ide0: BM-DMA at 0xc020-0xc027
    ide1: BM-DMA at 0xc028-0xc02f
hda: QEMU HARDDISK, ATA DISK drive
hda: MWDMA2 mode selected
hdc: QEMU DVD-ROM, ATAPI CD/DVD-ROM drive
hdc: MWDMA2 mode selected
ide0 at 0x1f0-0x1f7,0x3f6 on irq 14
ide1 at 0x170-0x177,0x376 on irq 15
ide-gd driver 1.18
hda: max request size: 512KiB
hda: 1348484 sectors (690 MB) w/256KiB Cache, CHS=1337/255/63
hda: cache flushes supported
 hda: unknown partition table
ide-cd driver 5.00
ide-cd: hdc: ATAPI 4X DVD-ROM drive, 512kB Cache
cdrom: Uniform CD-ROM driver Revision: 3.20
tun: Universal TUN/TAP device driver, 1.6
tun: (C) 1999-2004 Max Krasnyansky <maxk@qualcomm.com>
pcnet32: pcnet32.c:v1.35 21.Apr.2008 tsbogend@alpha.franken.de
e100: Intel(R) PRO/100 Network Driver, 3.5.24-k2-NAPI
e100: Copyright(c) 1999-2006 Intel Corporation
e1000: Intel(R) PRO/1000 Network Driver - version 7.3.21-k8-NAPI
e1000: Copyright (c) 1999-2006 Intel Corporation.
e1000e: Intel(R) PRO/1000 Network Driver - 1.9.5-k
e1000e: Copyright(c) 1999 - 2012 Intel Corporation.
igb: Intel(R) Gigabit Ethernet Network Driver - version 3.2.10-k
igb: Copyright (c) 2007-2012 Intel Corporation.
igbvf: Intel(R) Gigabit Virtual Function Network Driver - version 2.0.1-k
igbvf: Copyright (c) 2009 - 2012 Intel Corporation.
ehci_hcd: USB 2.0 'Enhanced' Host Controller (EHCI) Driver
uhci_hcd: USB Universal Host Controller Interface driver
Initializing USB Mass Storage driver...
usbcore: registered new interface driver usb-storage
USB Mass Storage support registered.
i8042: PNP: PS/2 Controller [PNP0303:KBD,PNP0f13:MOU] at 0x60,0x64 irq 1,12
serio: i8042 KBD port at 0x60,0x64 irq 1
serio: i8042 AUX port at 0x60,0x64 irq 12
mousedev: PS/2 mouse device common for all mice
input: AT Translated Set 2 keyboard as /devices/platform/i8042/serio0/input/input1
rtc_cmos 00:01: RTC can wake from S4
rtc_cmos 00:01: rtc core: registered rtc_cmos as rtc0
rtc0: alarms up to one day, 114 bytes nvram, hpet irqs
md: linear personality registered for level -1
md: raid0 personality registered for level 0
md: raid1 personality registered for level 1
md: raid10 personality registered for level 10
md: multipath personality registered for level -4
md: faulty personality registered for level -5
device-mapper: ioctl: 4.22.0-ioctl (2011-10-19) initialised: dm-devel@redhat.com
cpuidle: using governor ladder
cpuidle: using governor menu
usbcore: registered new interface driver usbhid
usbhid: USB HID core driver
oprofile: using NMI interrupt.
TCP: cubic registered
NET: Registered protocol family 10
IPv6 over IPv4 tunneling driver
NET: Registered protocol family 17
Registering the dns_resolver key type
registered taskstats version 1
console [netcon0] enabled
netconsole: network logging started
rtc_cmos 00:01: setting system clock to 2012-12-23 12:58:22 UTC (1356267502)
Sending DHCP requests .
input: ImExPS/2 Generic Explorer Mouse as /devices/platform/i8042/serio1/input/input2
, OK
IP-Config: Got DHCP answer from 128.224.165.20, my address is 128.224.165.245
IP-Config: Complete:
     device=eth0, addr=128.224.165.245, mask=255.255.255.0, gw=128.224.165.1
     host=128.224.165.245, domain=pek-tuxlab.wrs.com, nis-domain=(none)
     bootserver=128.224.165.20, rootserver=128.224.165.20, rootpath=
md: Waiting for all devices to be available before autodetect
md: If you don't use raid, use raid=noautodetect
md: Autodetecting RAID arrays.
md: Scanned 0 and added 0 devices.
md: autorun ...
md: ... autorun DONE.
kjournald starting.  Commit interval 5 seconds
EXT3-fs (hda): warning: maximal mount count reached, running e2fsck is recommended
EXT3-fs (hda): using internal journal
EXT3-fs (hda): mounted filesystem with ordered data mode
VFS: Mounted root (ext3 filesystem) on device 3:0.
devtmpfs: mounted
Freeing unused kernel memory: 728k freed
Write protecting the kernel read-only data: 12288k
Freeing unused kernel memory: 1460k freed
Freeing unused kernel memory: 1600k freed
INIT: version 2.88 booting
Starting udev
udev[56]: starting version 164
kvm: Nested Virtualization enabled
The Guest MAC is de:ef:be:47:25:14 

GUEST_IP is 128.224.165.245 

Floppy drive(s): fd0 is 1.44M
parport_pc 00:05: reported by Plug and Play ACPI
FDC 0 is a S82078B
parport0: PC-style at 0x378, irq 7 [PCSPP(,...)]
end_request: I/O error, dev fd0, sector 0
end_request: I/O error, dev fd0, sector 0
end_request: I/O error, dev fd0, sector 0
end_request: I/O error, dev fd0, sector 0
Starting Bootlog daemon: bootlogd.
show the networking on the Guest
eth0      Link encap:Ethernet  HWaddr de:ef:be:47:25:14  
          inet addr:128.224.165.245  Bcast:128.224.165.255  Mask:255.255.255.0
          inet6 addr: fe80::dcef:beff:fe47:2514/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:74 errors:0 dropped:11 overruns:0 frame:0
          TX packets:11 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:12017 (11.7 KiB)  TX bytes:1794 (1.7 KiB)

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

Configuring network interfaces... ifup: don't seem to have all the variables for eth0/inet
done.
Starting portmap daemon...
net.ipv4.conf.default.rp_filter = 1
net.ipv4.conf.all.rp_filter = 1
Starting atd: OK
INIT: Entering runlevel: 3
Starting system message bus: dbus.
Starting OpenBSD Secure Shell server: sshd
done.
Starting Advanced Configuration and Power Interface daemon: acpid.
acpid: starting up

acpid: opendir(/etc/acpi/events): No such file or directory

Starting domain name service: namedchmod: cannot access `/var/run/bind/run': No such file or directory
.
Starting Distributed Compiler Daemon: distcc.
starting DNS forwarder and DHCP server: dnsmasq... 
dnsmasq: failed to bind listening socket for 128.224.165.245: Address already in use
Starting libvirtd daemon: 
creating NFS state directory: done
Bridge firewalling registered
NFS daemon support not enabled in kernel
Starting ntpd: ip_tables: (C) 2000-2006 Netfilter Core Team
done
Starting system log daemon...0
Starting kernel log daemon...nf_conntrack version 0.5.0 (3938 buckets, 15752 max)
0
 * Starting Avahi mDNS/DNS-SD Daemon: avahi-daemon
ADDRCONF(NETDEV_UP): virbr0: link is not ready
[A[74G[ ok ]
Starting crond: OK
Starting tcf-agent: OK
Stopping Bootlog daemon: bootlogd.
c
Wind River Linux 5.0.1.0 localhost console

localhost login: ip6_tables: (C) 2000-2006 Netfilter Core Team
********************************************************************
ssh to the guest and run the command ls /boot/ 

bzImage
bzImage-3.4.20-WR5.0.1.0_standard
Run ls /boot/ on guest sucessfully
********************************************************************
Guest is distoried 

********************************************************************
TEST STATUS:
            "VIRTIO" TEST ---> PASS
